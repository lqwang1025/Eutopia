[Graph]
name=Lenet;
training=true;
batch=128;

[Input]
name=data;
producer=[];
dims={ shape:
	 { batch: 20,
	   heght: 28,
	   width: 28,
	   channles: 1 }
      };
preprocess={ mean: 0, var: 255.0 };

[Convolution2D]
name=conv1;
producer=[data];
op_param={ filters: 96,
           kernels: [5, 5],
           strides: [1, 1],
	   padding: SAME,
	   pads: [0, 0, 0, 0],
	   activation: relu,
	   dilations: [1, 1, 1, 1],
	   group: 1};
weight_filler=xavier;
bias_filler=constant;

[Pooling]
name=pool1;
producer=[conv1];
op_param={ kernels: [2, 2], 
	   strides: [2, 2],
	   pool_type: MAX};

[Convolution2D]
name=conv2;
producer=[pool1];
op_param={ filters: 50,
	   kernels: [5, 5],
	   strides: [1, 1],
	   padding: SAME,
	   pads: [0, 0, 0, 0],
	   activation: relu,
	   dilations: [1, 1, 1, 1],
	   group: 1};
weight_filler=xavier;
bias_filler=constant;

[Pooling]
name=pool2;
producer=[conv2];
op_param={ kernels: [2, 2], 
	   strides: [2, 2],
	   pool_type: MAX};

[FullyConnected]
name=fc1;
producer=[pool2];
op_param={ num_outputs: 500, activation: relu };
weight_filler=xavier;
bias_filler=constant;

[FullyConnected]
name=fc2;
producer=[fc1];
op_param={ num_outputs: 10};
weight_filler=xavier;
bias_filler=constant;
